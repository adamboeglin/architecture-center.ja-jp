---
title: マイクロサービス アーキテクチャの概要
description: マイクロサービス アーキテクチャの概要。
author: MikeWasson
ms.date: 02/26/2019
ms.topic: guide
ms.service: architecture-center
ms.subservice: reference-architecture
ms.custom: microservices
ms.openlocfilehash: fbb79ea2f9a4822fb221b99ce5e94ce78067fd1f
ms.sourcegitcommit: c053e6edb429299a0ad9b327888d596c48859d4a
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/20/2019
ms.locfileid: "58241503"
---
# <a name="introduction-to-microservices-architectures"></a><span data-ttu-id="e7f5a-103">マイクロサービス アーキテクチャの概要</span><span class="sxs-lookup"><span data-stu-id="e7f5a-103">Introduction to microservices architectures</span></span>

<span data-ttu-id="e7f5a-104">マイクロサービス アーキテクチャは、小さな自律サービスのコレクションで構成されています。</span><span class="sxs-lookup"><span data-stu-id="e7f5a-104">A microservices architecture consists of a collection of small, autonomous services.</span></span> <span data-ttu-id="e7f5a-105">各サービスは自己完結型であり、1 つのビジネス機能を実装している必要があります。</span><span class="sxs-lookup"><span data-stu-id="e7f5a-105">Each service is self-contained and should implement a single business capability.</span></span> <span data-ttu-id="e7f5a-106">以下に、マイクロサービスの特徴を定義します。</span><span class="sxs-lookup"><span data-stu-id="e7f5a-106">Here are some of the defining characteristics of microservices:</span></span>

- <span data-ttu-id="e7f5a-107">マイクロサービス アーキテクチャでは、サービスは小さく、独立的で、疎結合しています。</span><span class="sxs-lookup"><span data-stu-id="e7f5a-107">In a microservices architecture, services are small, independent, and loosely coupled.</span></span>
- <span data-ttu-id="e7f5a-108">マイクロサービスは小さいため、小規模な 1 つの開発者チームで作成および管理できます。</span><span class="sxs-lookup"><span data-stu-id="e7f5a-108">A microservice is small enough that a single small team of developers can write and maintain it.</span></span>
- <span data-ttu-id="e7f5a-109">サービスは個別にデプロイできます。</span><span class="sxs-lookup"><span data-stu-id="e7f5a-109">Services can be deployed independently.</span></span> <span data-ttu-id="e7f5a-110">チームは、アプリケーション全体を再構築したり再デプロイしたりすることなく、既存のサービスを更新できます。</span><span class="sxs-lookup"><span data-stu-id="e7f5a-110">A team can update an existing service without rebuilding and redeploying the entire application.</span></span>
- <span data-ttu-id="e7f5a-111">サービスはサービスのデータや外部の状態を保持する役割を担います。</span><span class="sxs-lookup"><span data-stu-id="e7f5a-111">Services are responsible for persisting their own data or external state.</span></span> <span data-ttu-id="e7f5a-112">これは、個別のデータ層でデータを保持する従来のモデルと異なる点です。</span><span class="sxs-lookup"><span data-stu-id="e7f5a-112">This differs from the traditional model, where a separate data layer handles data persistence.</span></span>
- <span data-ttu-id="e7f5a-113">サービスは、明確に定義された API を使用して、互いに通信します。</span><span class="sxs-lookup"><span data-stu-id="e7f5a-113">Services communicate with each other by using well-defined APIs.</span></span> <span data-ttu-id="e7f5a-114">各サービス内部の実装の詳細は、他のサービスに開示されません。</span><span class="sxs-lookup"><span data-stu-id="e7f5a-114">Internal implementation details of each service are hidden from other services.</span></span>
- <span data-ttu-id="e7f5a-115">サービスは、同じテクノロジ スタック、ライブラリ、またはフレームワークを共有する必要はありません。</span><span class="sxs-lookup"><span data-stu-id="e7f5a-115">Services don't need to share the same technology stack, libraries, or frameworks.</span></span>

![マイクロサービスの論理アーキテクチャ](../guide/architecture-styles/images/microservices-logical.svg)

<!-- markdownlint-disable MD026 -->

## <a name="why-build-microservices"></a><span data-ttu-id="e7f5a-117">マイクロサービスを構築する理由</span><span class="sxs-lookup"><span data-stu-id="e7f5a-117">Why build microservices?</span></span>

<span data-ttu-id="e7f5a-118">マイクロサービスにより、以下のような有益なメリットが多数もたらされます。</span><span class="sxs-lookup"><span data-stu-id="e7f5a-118">Microservices can provide a number of useful benefits:</span></span>

- <span data-ttu-id="e7f5a-119">**機敏性。**</span><span class="sxs-lookup"><span data-stu-id="e7f5a-119">**Agility.**</span></span> <span data-ttu-id="e7f5a-120">マイクロサービスは個別にデプロイされるため、バグ修正や機能リリースが管理しやすくなります。</span><span class="sxs-lookup"><span data-stu-id="e7f5a-120">Because microservices are deployed independently, it's easier to manage bug fixes and feature releases.</span></span> <span data-ttu-id="e7f5a-121">アプリケーション全体を再デプロイしなくてもサービスを更新できるほか、問題が発生したときに更新プログラムをロールバックできます。</span><span class="sxs-lookup"><span data-stu-id="e7f5a-121">You can update a service without redeploying the entire application, and roll back an update if something goes wrong.</span></span> <span data-ttu-id="e7f5a-122">従来のアプリケーションでは、多くの場合、アプリケーションの一部にバグが見つかると、リリース プロセス全体がブロックされ、その結果、新機能はバグ修正が統合、テスト、および公開されるまで使用できなくなる可能性があります。</span><span class="sxs-lookup"><span data-stu-id="e7f5a-122">In many traditional applications, if a bug is found in one part of the application, it can block the entire release process; as a result, new features may be held up waiting for a bug fix to be integrated, tested, and published.</span></span>  

- <span data-ttu-id="e7f5a-123">**短いコード、小規模チーム。**</span><span class="sxs-lookup"><span data-stu-id="e7f5a-123">**Small code, small teams.**</span></span> <span data-ttu-id="e7f5a-124">マイクロサービスの規模は小さく、1 つの機能チームによって構築、テスト、およびデプロイできます。</span><span class="sxs-lookup"><span data-stu-id="e7f5a-124">A microservice should be small enough that a single feature team can build, test, and deploy it.</span></span> <span data-ttu-id="e7f5a-125">コード ベースは小さいほど、わかりやすくなります。</span><span class="sxs-lookup"><span data-stu-id="e7f5a-125">Small code bases are easier to understand.</span></span> <span data-ttu-id="e7f5a-126">大規模なモノリシック アプリケーションでは、時間の経過に伴ってコードの依存関係が複雑になる傾向にあり、新しい機能を追加しようとすると、多くの場所でコード変更が必要です。</span><span class="sxs-lookup"><span data-stu-id="e7f5a-126">In a large monolithic application, there is a tendency over time for code dependencies to become tangled, so that adding a new feature requires touching code in a lot of places.</span></span> <span data-ttu-id="e7f5a-127">マイクロサービス アーキテクチャでは、コードまたはデータ ストアが共有されないため、依存関係を最小限に抑え、新しい機能を簡単に追加できます。</span><span class="sxs-lookup"><span data-stu-id="e7f5a-127">By not sharing code or data stores, a microservices architecture minimizes dependencies, and that makes it easier to add new features.</span></span> <span data-ttu-id="e7f5a-128">小規模なチーム編成も機敏性を向上させます。</span><span class="sxs-lookup"><span data-stu-id="e7f5a-128">Small team sizes also promote greater agility.</span></span> <span data-ttu-id="e7f5a-129">"2 枚のピザ ルール" も、チームは 2 枚のピザが行き渡る人数に抑える必要がある、となっています。</span><span class="sxs-lookup"><span data-stu-id="e7f5a-129">The "two-pizza rule" says that a team should be small enough that two pizzas can feed the team.</span></span> <span data-ttu-id="e7f5a-130">もちろん、これは正確な基準ではなく、チームの食欲によっても変わります。</span><span class="sxs-lookup"><span data-stu-id="e7f5a-130">Obviously that's not an exact metric and depends on team appetites!</span></span> <span data-ttu-id="e7f5a-131">しかし、重要なのは、大規模なグループでは、コミュニケーションに時間がかかり、管理オーバーヘッドが増大し、機敏性も低下するため、生産性が低くなる傾向があるという点です。</span><span class="sxs-lookup"><span data-stu-id="e7f5a-131">But the point is that large groups tend be less productive, because communication is slower, management overhead goes up, and agility diminishes.</span></span>  

- <span data-ttu-id="e7f5a-132">**テクノロジの組み合わせ**。</span><span class="sxs-lookup"><span data-stu-id="e7f5a-132">**Mix of technologies**.</span></span> <span data-ttu-id="e7f5a-133">必要に応じて、チームがテクノロジ スタックを組み合わせて、サービスに最適なテクノロジを選択できます。</span><span class="sxs-lookup"><span data-stu-id="e7f5a-133">Teams can pick the technology that best fits their service, using a mix of technology stacks as appropriate.</span></span> 

- <span data-ttu-id="e7f5a-134">**回復性**。</span><span class="sxs-lookup"><span data-stu-id="e7f5a-134">**Resiliency**.</span></span> <span data-ttu-id="e7f5a-135">個々のマイクロサービスが使用できなくなっても、上流マイクロサービスが障害を正しく処理するように設計されている限り (サーキット ブレークの実装など)、アプリケーション全体が中断されることはありません。</span><span class="sxs-lookup"><span data-stu-id="e7f5a-135">If an individual microservice becomes unavailable, it won't disrupt the entire application, as long as any upstream microservices are designed to handle faults correctly (for example, by implementing circuit breaking).</span></span>

- <span data-ttu-id="e7f5a-136">**スケーラビリティ**: </span><span class="sxs-lookup"><span data-stu-id="e7f5a-136">**Scalability**.</span></span> <span data-ttu-id="e7f5a-137">マイクロサービス アーキテクチャでは、各マイクロサービスを個別に拡張できます。</span><span class="sxs-lookup"><span data-stu-id="e7f5a-137">A microservices architecture allows each microservice to be scaled independently of the others.</span></span> <span data-ttu-id="e7f5a-138">つまり、サブシステムにさらに多くのリソースが必要な場合、アプリケーション全体をスケールアウトせずに、サブシステムをスケールアウトすることができます。</span><span class="sxs-lookup"><span data-stu-id="e7f5a-138">That lets you scale out subsystems that require more resources, without scaling out the entire application.</span></span> <span data-ttu-id="e7f5a-139">コンテナー内にサービスをデプロイすると、マイクロサービスを高密度で 1 つのホストに圧縮できるため、リソースをより効率的に使用できます。</span><span class="sxs-lookup"><span data-stu-id="e7f5a-139">If you deploy services inside containers, you can also pack a higher density of microservices onto a single host, which allows for more efficient utilization of resources.</span></span>

- <span data-ttu-id="e7f5a-140">**データの分離**。</span><span class="sxs-lookup"><span data-stu-id="e7f5a-140">**Data isolation**.</span></span> <span data-ttu-id="e7f5a-141">影響を受けるのは 1 つのマイクロサービスだけであるため、スキーマ更新がはるかに実行しやすくなります。</span><span class="sxs-lookup"><span data-stu-id="e7f5a-141">It is much easier to perform schema updates, because only a single microservice is impacted.</span></span> <span data-ttu-id="e7f5a-142">モノリシック アプリケーションでは、アプリケーションのさまざまな部分すべてが同じデータに影響する可能性があり、スキーマの変更にはリスクが伴うため、スキーマ更新は非常に困難になる可能性があります。</span><span class="sxs-lookup"><span data-stu-id="e7f5a-142">In a monolithic application, schema updates can become very challenging, because different parts of the application may all touch the same data, making any alterations to the schema risky.</span></span>

## <a name="when-should-i-build-microservices"></a><span data-ttu-id="e7f5a-143">マイクロサービスを構築する必要がある状況</span><span class="sxs-lookup"><span data-stu-id="e7f5a-143">When should I build microservices?</span></span>

<span data-ttu-id="e7f5a-144">次の場合に、マイクロサービス アーキテクチャを検討してください。</span><span class="sxs-lookup"><span data-stu-id="e7f5a-144">Consider a microservices architecture for:</span></span>

- <span data-ttu-id="e7f5a-145">リリースの早さが要求される大規模アプリケーション。</span><span class="sxs-lookup"><span data-stu-id="e7f5a-145">Large applications that require a high release velocity.</span></span>
- <span data-ttu-id="e7f5a-146">高い拡張性が必要とされる複雑なアプリケーション。</span><span class="sxs-lookup"><span data-stu-id="e7f5a-146">Complex applications that need to be highly scalable.</span></span>
- <span data-ttu-id="e7f5a-147">ドメインが豊富な、またはサブドメインが多いアプリケーション。</span><span class="sxs-lookup"><span data-stu-id="e7f5a-147">Applications with rich domains or many subdomains.</span></span>
- <span data-ttu-id="e7f5a-148">小規模な開発チームから構成されている組織。</span><span class="sxs-lookup"><span data-stu-id="e7f5a-148">An organization that consists of small development teams.</span></span>

## <a name="challenges"></a><span data-ttu-id="e7f5a-149">課題</span><span class="sxs-lookup"><span data-stu-id="e7f5a-149">Challenges</span></span>

<span data-ttu-id="e7f5a-150">マイクロサービスの利点は、何もせずに手に入るものではありません。</span><span class="sxs-lookup"><span data-stu-id="e7f5a-150">The benefits of microservices don't come for free.</span></span> <span data-ttu-id="e7f5a-151">マイクロサービス アーキテクチャに着手する前に考慮すべき課題の一部を示します。</span><span class="sxs-lookup"><span data-stu-id="e7f5a-151">Here are some of the challenges to consider before embarking on a microservices architecture.</span></span>

- <span data-ttu-id="e7f5a-152">**複雑さ**。</span><span class="sxs-lookup"><span data-stu-id="e7f5a-152">**Complexity**.</span></span> <span data-ttu-id="e7f5a-153">マイクロサービス アプリケーションは、同等のモノリシック アプリケーションよりも多くの動的パーツで構成されています。</span><span class="sxs-lookup"><span data-stu-id="e7f5a-153">A microservices application has more moving parts than the equivalent monolithic application.</span></span> <span data-ttu-id="e7f5a-154">各サービスはより単純ですが、システム全体としてはより複雑です。</span><span class="sxs-lookup"><span data-stu-id="e7f5a-154">Each service is simpler, but the entire system as a whole is more complex.</span></span>

- <span data-ttu-id="e7f5a-155">**開発とテスト**。</span><span class="sxs-lookup"><span data-stu-id="e7f5a-155">**Development and testing**.</span></span> <span data-ttu-id="e7f5a-156">他の依存サービスに依存する小さいサービスを作成するには、従来のモノリシックまたは階層化アプリケーションを作成するのとは異なるアプローチが求められます。</span><span class="sxs-lookup"><span data-stu-id="e7f5a-156">Writing a small service that relies on other dependent services requires a different approach than a writing a traditional monolithic or layered application.</span></span> <span data-ttu-id="e7f5a-157">既存のツールは、サービスの依存関係を処理するように設計されているとは限りません。</span><span class="sxs-lookup"><span data-stu-id="e7f5a-157">Existing tools are not always designed to work with service dependencies.</span></span> <span data-ttu-id="e7f5a-158">サービス間の境界にまたがってリファクタリングを行うことは困難です。</span><span class="sxs-lookup"><span data-stu-id="e7f5a-158">Refactoring across service boundaries can be difficult.</span></span> <span data-ttu-id="e7f5a-159">また、アプリケーションの進化が早い場合は特に、サービスの依存関係をテストすることは困難です。</span><span class="sxs-lookup"><span data-stu-id="e7f5a-159">It is also challenging to test service dependencies, especially when the application is evolving quickly.</span></span>

- <span data-ttu-id="e7f5a-160">**ガバナンスの欠如**。</span><span class="sxs-lookup"><span data-stu-id="e7f5a-160">**Lack of governance**.</span></span> <span data-ttu-id="e7f5a-161">マイクロサービスを構築する際に分散アプローチをとることにはメリットがありますが、問題が発生しやすくもなります。</span><span class="sxs-lookup"><span data-stu-id="e7f5a-161">The decentralized approach to building microservices has advantages, but it can also lead to problems.</span></span> <span data-ttu-id="e7f5a-162">多くの異なる言語やフレームワークを使用するために、アプリケーションの維持が難しくなることがあります。</span><span class="sxs-lookup"><span data-stu-id="e7f5a-162">You may end up with so many different languages and frameworks that the application becomes hard to maintain.</span></span> <span data-ttu-id="e7f5a-163">プロジェクト全体に適用される標準を導入する方が役立ち、チームの柔軟性を過度に制限せずに済むということもあります。</span><span class="sxs-lookup"><span data-stu-id="e7f5a-163">It may be useful to put some project-wide standards in place, without overly restricting teams' flexibility.</span></span> <span data-ttu-id="e7f5a-164">これは特に、ログ記録などの横断的な機能に適用されます。</span><span class="sxs-lookup"><span data-stu-id="e7f5a-164">This especially applies to cross-cutting functionality such as logging.</span></span>

- <span data-ttu-id="e7f5a-165">**ネットワークの輻輳と待機時間**。</span><span class="sxs-lookup"><span data-stu-id="e7f5a-165">**Network congestion and latency**.</span></span> <span data-ttu-id="e7f5a-166">多くの小さく細分化されたサービスを使用すると、よりインタラクティブな通信が可能になります。</span><span class="sxs-lookup"><span data-stu-id="e7f5a-166">The use of many small, granular services can result in more interservice communication.</span></span> <span data-ttu-id="e7f5a-167">また、サービスの依存関係のチェーンが長すぎる (サービス A が B を呼び出し、その B が C を呼び出すなどの) 場合、追加される待機時間が問題になることがあります。</span><span class="sxs-lookup"><span data-stu-id="e7f5a-167">Also, if the chain of service dependencies gets too long (service A calls B, which calls C...), the additional latency can become a problem.</span></span> <span data-ttu-id="e7f5a-168">API は慎重に設計する必要があります。</span><span class="sxs-lookup"><span data-stu-id="e7f5a-168">You will need to design APIs carefully.</span></span> <span data-ttu-id="e7f5a-169">API を過度に使用することを避け、シリアル化形式について検討し、非同期通信パターンを使用する場所を探してください。</span><span class="sxs-lookup"><span data-stu-id="e7f5a-169">Avoid overly chatty APIs, think about serialization formats, and look for places to use asynchronous communication patterns.</span></span>

- <span data-ttu-id="e7f5a-170">**データ整合性**。</span><span class="sxs-lookup"><span data-stu-id="e7f5a-170">**Data integrity**.</span></span> <span data-ttu-id="e7f5a-171">独自のデータを永続化する各マイクロサービスを使用します。</span><span class="sxs-lookup"><span data-stu-id="e7f5a-171">With each microservice responsible for its own data persistence.</span></span> <span data-ttu-id="e7f5a-172">結果として、データの整合性をとることが難しくなることがあります。</span><span class="sxs-lookup"><span data-stu-id="e7f5a-172">As a result, data consistency can be a challenge.</span></span> <span data-ttu-id="e7f5a-173">可能であれば、最終的な整合性を優先します。</span><span class="sxs-lookup"><span data-stu-id="e7f5a-173">Embrace eventual consistency where possible.</span></span>

- <span data-ttu-id="e7f5a-174">**管理**。</span><span class="sxs-lookup"><span data-stu-id="e7f5a-174">**Management**.</span></span> <span data-ttu-id="e7f5a-175">マイクロサービスを成功させるには、成熟した DevOps カルチャが必要です。</span><span class="sxs-lookup"><span data-stu-id="e7f5a-175">To be successful with microservices requires a mature DevOps culture.</span></span> <span data-ttu-id="e7f5a-176">サービス間で相互に関連付けられたログを記録することは難しい場合があります。</span><span class="sxs-lookup"><span data-stu-id="e7f5a-176">Correlated logging across services can be challenging.</span></span> <span data-ttu-id="e7f5a-177">通常、ログ記録は単一のユーザー操作を要求するために複数のサービスの呼び出しを関連付ける必要があります。</span><span class="sxs-lookup"><span data-stu-id="e7f5a-177">Typically, logging must correlate multiple service calls for a single user operation.</span></span>

- <span data-ttu-id="e7f5a-178">**バージョン管理**。</span><span class="sxs-lookup"><span data-stu-id="e7f5a-178">**Versioning**.</span></span> <span data-ttu-id="e7f5a-179">サービスの更新プログラムは、依存しているサービスを中断してはいけません。</span><span class="sxs-lookup"><span data-stu-id="e7f5a-179">Updates to a service must not break services that depend on it.</span></span> <span data-ttu-id="e7f5a-180">複数のサービスが特定の時点で更新される場合があるため、慎重に設計しないと下位互換性または上位互換性に問題が生じる可能性があります。</span><span class="sxs-lookup"><span data-stu-id="e7f5a-180">Multiple services could be updated at any given time, so without careful design, you might have problems with backward or forward compatibility.</span></span>

- <span data-ttu-id="e7f5a-181">**スキルセット**。</span><span class="sxs-lookup"><span data-stu-id="e7f5a-181">**Skillset**.</span></span> <span data-ttu-id="e7f5a-182">マイクロサービスは高度な分散システムです。</span><span class="sxs-lookup"><span data-stu-id="e7f5a-182">Microservices are highly distributed systems.</span></span> <span data-ttu-id="e7f5a-183">成功のために必要なスキルと経験がチームにあるかどうかを慎重に評価してください。</span><span class="sxs-lookup"><span data-stu-id="e7f5a-183">Carefully evaluate whether the team has the skills and experience to be successful.</span></span>

## <a name="next-steps"></a><span data-ttu-id="e7f5a-184">次の手順</span><span class="sxs-lookup"><span data-stu-id="e7f5a-184">Next steps</span></span>

- <span data-ttu-id="e7f5a-185">マイクロサービスに関する最大の課題の 1 つは、適切なサービス境界を作成することです。</span><span class="sxs-lookup"><span data-stu-id="e7f5a-185">One of the biggest challenges with microservices is to create the right service boundaries.</span></span> <span data-ttu-id="e7f5a-186">[マイクロサービスのモデル化](./model/domain-analysis.md)に関するページにある記事に、この問題に対するドメイン駆動アプローチが紹介されています。</span><span class="sxs-lookup"><span data-stu-id="e7f5a-186">The articles under [Modeling microservices](./model/domain-analysis.md) show a domain-driven approach to this problem.</span></span>
