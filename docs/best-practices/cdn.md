---
title: Content Delivery Network のガイダンス
titleSuffix: Best practices for cloud applications
description: コンテンツ配信ネットワーク (CDN) を使用して Azure でホストされている広帯域幅コンテンツを配信するためのガイダンス。
author: dragon119
ms.date: 02/02/2018
ms.topic: best-practice
ms.service: architecture-center
ms.subservice: cloud-fundamentals
ms.custom: seodec18
ms.openlocfilehash: f4ffe9c5cdd7a53ab8359ef303076c5e53e9e45c
ms.sourcegitcommit: c053e6edb429299a0ad9b327888d596c48859d4a
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/20/2019
ms.locfileid: "58249107"
---
# <a name="content-delivery-networks-cdns"></a><span data-ttu-id="f2fb5-103">コンテンツ配信ネットワーク (CDN)</span><span class="sxs-lookup"><span data-stu-id="f2fb5-103">Content delivery networks (CDNs)</span></span>

<span data-ttu-id="f2fb5-104">コンテンツ配信ネットワーク (CDN) は、ユーザーに Web コンテンツを効率的に配信できるサーバーの分散ネットワークです。</span><span class="sxs-lookup"><span data-stu-id="f2fb5-104">A content delivery network (CDN) is a distributed network of servers that can efficiently deliver web content to users.</span></span> <span data-ttu-id="f2fb5-105">CDN では、待機時間を最小限に抑えるために、エンドユーザーに近いエッジ サーバーに、キャッシュされたコンテンツを格納します。</span><span class="sxs-lookup"><span data-stu-id="f2fb5-105">CDNs store cached content on edge servers that are close to end-users, to minimize latency.</span></span>

<span data-ttu-id="f2fb5-106">CDN は通常、イメージ、スタイル シート、ドキュメント、クライアント側スクリプト、HTML ページなどの静的コンテンツの配信に使用されます。</span><span class="sxs-lookup"><span data-stu-id="f2fb5-106">CDNs are typically used to deliver static content such as images, style sheets, documents, client-side scripts, and HTML pages.</span></span> <span data-ttu-id="f2fb5-107">CDN を使用する主な利点は、アプリケーションがホストされているデータセンターに対してユーザーの位置する地理的な場所に関係なく、短い待ち時間でコンテンツをユーザーに高速配信できることです。</span><span class="sxs-lookup"><span data-stu-id="f2fb5-107">The major advantages of using a CDN are lower latency and faster delivery of content to users, regardless of their geographical location in relation to the datacenter where the application is hosted.</span></span> <span data-ttu-id="f2fb5-108">また、アプリケーションが CDN でホストされているコンテンツに対してサービス要求を行う必要はないため、CDN は Web アプリケーションの負荷の軽減にも役立ちます。</span><span class="sxs-lookup"><span data-stu-id="f2fb5-108">CDNs can also help to reduce load on a web application, because the application does not have to service requests for the content that is hosted in the CDN.</span></span>

![CDN の図](./images/cdn/CDN.png)

<span data-ttu-id="f2fb5-110">Azure の [Azure Content Delivery Network](/azure/cdn/cdn-overview) は、Azure または他の任意の場所でホストされている高帯域幅コンテンツを配信するためのグローバル CDN ソリューションです。</span><span class="sxs-lookup"><span data-stu-id="f2fb5-110">In Azure, the [Azure Content Delivery Network](/azure/cdn/cdn-overview) is a global CDN solution for delivering high-bandwidth content that is hosted in Azure or any other location.</span></span> <span data-ttu-id="f2fb5-111">Azure CDN を使用すると、Azure Blob Storage、Web アプリケーション、仮想マシン、またはパブリック アクセス可能な Web サーバーから読み込んだ一般公開されているオブジェクトをキャッシュすることができます。</span><span class="sxs-lookup"><span data-stu-id="f2fb5-111">Using Azure CDN, you can cache publicly available objects loaded from Azure blob storage, a web application, virtual machine, any publicly accessible web server.</span></span>

<span data-ttu-id="f2fb5-112">このトピックでは、CDN を使用する場合の、いくつかの一般的なベスト プラクティスおよび考慮事項について説明します。</span><span class="sxs-lookup"><span data-stu-id="f2fb5-112">This topic describes some general best practices and considerations when using a CDN.</span></span> <span data-ttu-id="f2fb5-113">詳細については、[Azure CDN](/azure/cdn/) に関するページを参照してください。</span><span class="sxs-lookup"><span data-stu-id="f2fb5-113">For more information, see [Azure CDN](/azure/cdn/).</span></span>

## <a name="how-and-why-a-cdn-is-used"></a><span data-ttu-id="f2fb5-114">CDN の使用方法と使用する理由</span><span class="sxs-lookup"><span data-stu-id="f2fb5-114">How and why a CDN is used</span></span>

<span data-ttu-id="f2fb5-115">CDN の一般的な用途は次のとおりです。</span><span class="sxs-lookup"><span data-stu-id="f2fb5-115">Typical uses for a CDN include:</span></span>  

- <span data-ttu-id="f2fb5-116">クライアント アプリケーション用の静的リソースの配信 (多くの場合、Web サイトから)。</span><span class="sxs-lookup"><span data-stu-id="f2fb5-116">Delivering static resources for client applications, often from a website.</span></span> <span data-ttu-id="f2fb5-117">静的リソースとは、たとえば、イメージ、スタイル シート、ドキュメント、ファイル、クライアント側スクリプト、HTML ページ、HTML フラグメントなど、個々の要求に応じてサーバー側が変更する必要がないコンテンツです。</span><span class="sxs-lookup"><span data-stu-id="f2fb5-117">These resources can be images, style sheets, documents, files, client-side scripts, HTML pages, HTML fragments, or any other content that the server does not need to modify for each request.</span></span> <span data-ttu-id="f2fb5-118">アプリケーションでは、実行時にアイテムを作成し、CDN から使用できるようにすることもできますが (たとえば、最新ニュースの見出し一覧を作成するなど)、個々の要求に応じて実行することはありません。</span><span class="sxs-lookup"><span data-stu-id="f2fb5-118">The application can create items at runtime and make them available to the CDN (for example, by creating a list of current news headlines), but it does not do so for each request.</span></span>

- <span data-ttu-id="f2fb5-119">静的な共有パブリック コンテンツを携帯電話やタブレット コンピューターなどのデバイスに配信する。</span><span class="sxs-lookup"><span data-stu-id="f2fb5-119">Delivering public static and shared content to devices such as mobile phones and tablet computers.</span></span> <span data-ttu-id="f2fb5-120">アプリケーション自体は、さまざまなデバイス上で実行されているクライアントに API を提供する Web サービスです。</span><span class="sxs-lookup"><span data-stu-id="f2fb5-120">The application itself is a web service that offers an API to clients running on the various devices.</span></span> <span data-ttu-id="f2fb5-121">CDN は、クライアント UI の生成などの目的で、クライアントが使用する静的データセットを配信することもできます (Web サービスを介して)。</span><span class="sxs-lookup"><span data-stu-id="f2fb5-121">The CDN can also deliver static datasets (via the web service) for the clients to use, perhaps to generate the client UI.</span></span> <span data-ttu-id="f2fb5-122">たとえば、JSON または XML ドキュメントの配信に CDN を使用することができます。</span><span class="sxs-lookup"><span data-stu-id="f2fb5-122">For example, the CDN could be used to distribute JSON or XML documents.</span></span>

- <span data-ttu-id="f2fb5-123">専用のコンピューティング リソースを使用することなく、静的パブリック コンテンツのみで構成されている Web サイト全体をクライアントに提供。</span><span class="sxs-lookup"><span data-stu-id="f2fb5-123">Serving entire websites that consist of only public static content to clients, without requiring any dedicated compute resources.</span></span>

- <span data-ttu-id="f2fb5-124">オンデマンドでビデオ ファイルをクライアントにストリーミング。</span><span class="sxs-lookup"><span data-stu-id="f2fb5-124">Streaming video files to the client on demand.</span></span> <span data-ttu-id="f2fb5-125">ビデオの場合、CDN 接続を提供するデータセンターは世界各国にあるため、短い待機時間、信頼性の高い接続という利点があります。</span><span class="sxs-lookup"><span data-stu-id="f2fb5-125">Video benefits from the low latency and reliable connectivity available from the globally located datacenters that offer CDN connections.</span></span> <span data-ttu-id="f2fb5-126">Microsoft Azure Media Services (AMS) は、CDN に直接コンテンツを配信し、そこからさらに配信するために Azure CDN と統合されています。</span><span class="sxs-lookup"><span data-stu-id="f2fb5-126">Microsoft Azure Media Services (AMS) integrates with Azure CDN to deliver content directly to the CDN for further distribution.</span></span> <span data-ttu-id="f2fb5-127">詳しくは、「[ストリーミング エンドポイントの概要](/azure/media-services/media-services-streaming-endpoints-overview)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="f2fb5-127">For more information, see [Streaming endpoints overview](/azure/media-services/media-services-streaming-endpoints-overview).</span></span>

- <span data-ttu-id="f2fb5-128">ユーザーのエクスペリエンスを全般的に改善 (特に、アプリケーションをホストしているデータセンターから離れた場所で利用しているユーザー)。</span><span class="sxs-lookup"><span data-stu-id="f2fb5-128">Generally improving the experience for users, especially those located far from the datacenter hosting the application.</span></span> <span data-ttu-id="f2fb5-129">そのようなユーザーの場合、他の方法では、待機時間が長くなる場合があります。</span><span class="sxs-lookup"><span data-stu-id="f2fb5-129">These users might otherwise suffer higher latency.</span></span> <span data-ttu-id="f2fb5-130">多くの場合、Web アプリケーションに含まれるコンテンツのうち、大部分は静的コンテンツです。CDN を使用することで、パフォーマンスと全体的なユーザー エクスペリエンスを維持することができます。また、アプリケーションを複数のデータセンターにデプロイする必要がなくなります。</span><span class="sxs-lookup"><span data-stu-id="f2fb5-130">A large proportion of the total size of the content in a web application is often static, and using the CDN can help to maintain performance and overall user experience while eliminating the requirement to deploy the application to multiple data centers.</span></span> <span data-ttu-id="f2fb5-131">Azure CDN ノードの場所の一覧については、「[Azure CDN の POP の場所](/azure/cdn/cdn-pop-locations/)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="f2fb5-131">For a list of Azure CDN node locations, see [Azure CDN POP Locations](/azure/cdn/cdn-pop-locations/).</span></span>

- <span data-ttu-id="f2fb5-132">IoT (モノのインターネット) のソリューションをサポートする。</span><span class="sxs-lookup"><span data-stu-id="f2fb5-132">Supporting IoT (Internet of Things) solutions.</span></span> <span data-ttu-id="f2fb5-133">IoT ソリューションに関連する膨大な数のデバイスおよびアプライアンスでは、各デバイスに直接ファームウェアの更新を配布する必要がある場合、アプリケーションがすぐに過負荷になるおそれがあります。</span><span class="sxs-lookup"><span data-stu-id="f2fb5-133">The huge numbers of devices and appliances involved in an IoT solution could easily overwhelm an application if it had to distribute firmware updates directly to each device.</span></span>

- <span data-ttu-id="f2fb5-134">アプリケーションを拡張することなく、ピーク時や需要の急騰に対処。結果として、運用コストの増加を防ぐことができます。</span><span class="sxs-lookup"><span data-stu-id="f2fb5-134">Coping with peaks and surges in demand without requiring the application to scale, avoiding the consequent increased running costs.</span></span> <span data-ttu-id="f2fb5-135">たとえば、特定モデルのルーターなどのハードウェア デバイス、またはスマート TV などのコンシューマー デバイスを対象にした、オペレーティング システムの更新プログラムがリリースされた場合、短期間で数百万単位のユーザーやデバイスがダウンロードするので、需要が大きく跳ね上がります。</span><span class="sxs-lookup"><span data-stu-id="f2fb5-135">For example, when an update to an operating system is released for a hardware device such as a specific model of router, or for a consumer device such as a smart TV, there will be a huge peak in demand as it is downloaded by millions of users and devices over a short period.</span></span>

## <a name="challenges"></a><span data-ttu-id="f2fb5-136">課題</span><span class="sxs-lookup"><span data-stu-id="f2fb5-136">Challenges</span></span>

<span data-ttu-id="f2fb5-137">CDN の使用を計画する際には、いくつかの課題を考慮する必要があります。</span><span class="sxs-lookup"><span data-stu-id="f2fb5-137">There are several challenges to take into account when planning to use a CDN.</span></span>

- <span data-ttu-id="f2fb5-138">**デプロイ**」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="f2fb5-138">**Deployment**.</span></span> <span data-ttu-id="f2fb5-139">CDN のコンテンツ取得元を決定する必要があります。また、複数のストレージ システムにあるコンテンツをデプロイする必要があるかどうかを決定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="f2fb5-139">Decide the origin from which the CDN fetches the content, and whether you need to deploy the content in more than one storage system.</span></span> <span data-ttu-id="f2fb5-140">静的コンテンツとリソースをデプロイするプロセスを考慮してください。</span><span class="sxs-lookup"><span data-stu-id="f2fb5-140">Take into account the process for deploying static content and resources.</span></span> <span data-ttu-id="f2fb5-141">たとえば、Azure BLOB ストレージにコンテンツを読み込むために個別の手順の実装が必要になる場合があります。</span><span class="sxs-lookup"><span data-stu-id="f2fb5-141">For example, you may need to implement a separate step to load content into Azure blob storage.</span></span>

- <span data-ttu-id="f2fb5-142">**バージョン管理とキャッシュ制御**。</span><span class="sxs-lookup"><span data-stu-id="f2fb5-142">**Versioning and cache-control**.</span></span> <span data-ttu-id="f2fb5-143">静的コンテンツを更新する方法と、新しいバージョンをデプロイする方法を検討する必要があります。</span><span class="sxs-lookup"><span data-stu-id="f2fb5-143">Consider how you will update static content and deploy new versions.</span></span> <span data-ttu-id="f2fb5-144">CDN によるキャッシュと有効期限 (TTL) の実行方法を理解してください。</span><span class="sxs-lookup"><span data-stu-id="f2fb5-144">Understand how the CDN performs caching and time-to-live (TTL).</span></span> <span data-ttu-id="f2fb5-145">Azure CDN の[キャッシュのしくみ](/azure/cdn/cdn-how-caching-works)に関するページをご覧ください。</span><span class="sxs-lookup"><span data-stu-id="f2fb5-145">For Azure CDN, see [How caching works](/azure/cdn/cdn-how-caching-works).</span></span>

- <span data-ttu-id="f2fb5-146">**テスト**。</span><span class="sxs-lookup"><span data-stu-id="f2fb5-146">**Testing**.</span></span> <span data-ttu-id="f2fb5-147">アプリケーションをローカル環境やステージング環境で開発し、テストしている場合、CDN の設定をローカルでテストすることは困難になる可能性があります。</span><span class="sxs-lookup"><span data-stu-id="f2fb5-147">It can be difficult to perform local testing of your CDN settings when developing and testing an application locally or in a staging environment.</span></span>

- <span data-ttu-id="f2fb5-148">**検索エンジンの最適化 (SEO)**。</span><span class="sxs-lookup"><span data-stu-id="f2fb5-148">**Search engine optimization (SEO)**.</span></span> <span data-ttu-id="f2fb5-149">CDN を使用する場合、イメージやドキュメントなどのコンテンツは異なるドメインから提供されます。</span><span class="sxs-lookup"><span data-stu-id="f2fb5-149">Content such as images and documents are served from a different domain when you use the CDN.</span></span> <span data-ttu-id="f2fb5-150">このことは、このコンテンツの SEO に影響を及ぼします。</span><span class="sxs-lookup"><span data-stu-id="f2fb5-150">This can have an effect on SEO for this content.</span></span>

- <span data-ttu-id="f2fb5-151">**コンテンツのセキュリティ**。</span><span class="sxs-lookup"><span data-stu-id="f2fb5-151">**Content security**.</span></span> <span data-ttu-id="f2fb5-152">すべての CDN が、コンテンツに対して任意の形式のアクセス コントロールを提供しているわけではありません。</span><span class="sxs-lookup"><span data-stu-id="f2fb5-152">Not all CDNs offer any form of access control for the content.</span></span> <span data-ttu-id="f2fb5-153">Azure CDN などの一部の CDN サービスは、トークン ベースの認証をサポートして CDN コンテンツを保護しています。</span><span class="sxs-lookup"><span data-stu-id="f2fb5-153">Some CDN services, including Azure CDN, support token-based authentication to protect CDN content.</span></span> <span data-ttu-id="f2fb5-154">詳細については、「[トークン認証による Azure Content Delivery Network 資産の保護](/azure/cdn/cdn-token-auth)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="f2fb5-154">For more information, see [Securing Azure Content Delivery Network assets with token authentication](/azure/cdn/cdn-token-auth).</span></span>

- <span data-ttu-id="f2fb5-155">**クライアントのセキュリティ**。</span><span class="sxs-lookup"><span data-stu-id="f2fb5-155">**Client security**.</span></span> <span data-ttu-id="f2fb5-156">クライアントは、CDN 上のリソースへのアクセスを許可していない環境から接続している可能性があります。</span><span class="sxs-lookup"><span data-stu-id="f2fb5-156">Clients might connect from an environment that does not allow access to resources on the CDN.</span></span> <span data-ttu-id="f2fb5-157">たとえば、既知のリソースにのみアクセスが制限されているセキュリティに制約のある環境や、ページの提供元以外から配信されたリソースを読み込まない環境などです。</span><span class="sxs-lookup"><span data-stu-id="f2fb5-157">This could be a security-constrained environment that limits access to only a set of known sources, or one that prevents loading of resources from anything other than the page origin.</span></span> <span data-ttu-id="f2fb5-158">このような場合に対処するには、フォールバックの実装が必要です。</span><span class="sxs-lookup"><span data-stu-id="f2fb5-158">A fallback implementation is required to handle these cases.</span></span>

- <span data-ttu-id="f2fb5-159">**回復力**。</span><span class="sxs-lookup"><span data-stu-id="f2fb5-159">**Resilience**.</span></span> <span data-ttu-id="f2fb5-160">CDN は、アプリケーションの単一障害点になる可能性があります。</span><span class="sxs-lookup"><span data-stu-id="f2fb5-160">The CDN is a potential single point of failure for an application.</span></span>

<span data-ttu-id="f2fb5-161">CDN が適していないシナリオを次に示します。</span><span class="sxs-lookup"><span data-stu-id="f2fb5-161">Scenarios where CDN may be less useful include:</span></span>  

- <span data-ttu-id="f2fb5-162">コンテンツの有効期間中に、コンテンツのヒット率が低く、ほとんどアクセスされない場合 (その有効期限設定で決定)。</span><span class="sxs-lookup"><span data-stu-id="f2fb5-162">If the content has a low hit rate, it might be accessed only few times while it is valid (determined by its time-to-live setting).</span></span>

- <span data-ttu-id="f2fb5-163">データが非公開の場合。たとえば、大規模な企業やサプライ チェーンのエコシステムなどです。</span><span class="sxs-lookup"><span data-stu-id="f2fb5-163">If the data is private, such as for large enterprises or supply chain ecosystems.</span></span>

## <a name="general-guidelines-and-good-practices"></a><span data-ttu-id="f2fb5-164">一般的なガイドラインと推奨される方法</span><span class="sxs-lookup"><span data-stu-id="f2fb5-164">General guidelines and good practices</span></span>

<span data-ttu-id="f2fb5-165">CDN の使用は、アプリケーションの負荷を最小限に抑え、可用性とパフォーマンスを最大限にするために有効な方法です。</span><span class="sxs-lookup"><span data-stu-id="f2fb5-165">Using a CDN is a good way to minimize the load on your application, and maximize availability and performance.</span></span> <span data-ttu-id="f2fb5-166">アプリケーションで使用する適切なコンテンツとリソースのすべてに対して、この手法の採用を検討する必要があります。</span><span class="sxs-lookup"><span data-stu-id="f2fb5-166">Consider adopting this strategy for all of the appropriate content and resources your application uses.</span></span> <span data-ttu-id="f2fb5-167">CDN の使用戦略を立てるときは、次のセクションに示す項目を考慮してください。</span><span class="sxs-lookup"><span data-stu-id="f2fb5-167">Consider the points in the following sections when designing your strategy to use a CDN.</span></span>

### <a name="deployment"></a><span data-ttu-id="f2fb5-168">Deployment</span><span class="sxs-lookup"><span data-stu-id="f2fb5-168">Deployment</span></span>

<span data-ttu-id="f2fb5-169">アプリケーション デプロイメント パッケージまたはプロセスに静的コンテンツを含めない場合は、必要に応じて、アプリケーションとは別に静的コンテンツをプロビジョニングおよびデプロイします。</span><span class="sxs-lookup"><span data-stu-id="f2fb5-169">Static content may need to be provisioned and deployed independently from the application if you do not include it in the application deployment package or process.</span></span> <span data-ttu-id="f2fb5-170">アプリケーション コンポーネントと静的リソース コンテンツの両方を管理するために使用するバージョン管理アプローチに対して、どのような影響があるかを考慮してください。</span><span class="sxs-lookup"><span data-stu-id="f2fb5-170">Consider how this will affect the versioning approach you use to manage both the application components and the static resource content.</span></span>

<span data-ttu-id="f2fb5-171">バンドルと縮小の技術を使用して、クライアントの読み込み時間を短縮することを検討してください。</span><span class="sxs-lookup"><span data-stu-id="f2fb5-171">Consider using bundling and minification techniques to reduce load times for clients.</span></span> <span data-ttu-id="f2fb5-172">バンドルでは、複数のファイルを単一のファイルに連結します。</span><span class="sxs-lookup"><span data-stu-id="f2fb5-172">Bundling combines multiple files into a single file.</span></span> <span data-ttu-id="f2fb5-173">縮小では、機能を変更することなく、スクリプトおよび CSS ファイルから不要な文字を削除します。</span><span class="sxs-lookup"><span data-stu-id="f2fb5-173">Minification removes unnecessary characters from scripts and CSS files without altering functionality.</span></span>

<span data-ttu-id="f2fb5-174">コンテンツを追加の場所にデプロイする必要がある場合、デプロイメント プロセスの手順が増えます。</span><span class="sxs-lookup"><span data-stu-id="f2fb5-174">If you need to deploy the content to an additional location, this will be an extra step in the deployment process.</span></span> <span data-ttu-id="f2fb5-175">アプリケーションが、定期的に、またはイベントに応じて CDN のコンテンツを更新すると、更新されたコンテンツを CDN のエンドポイントだけでなく追加の場所にも保存する必要があります。</span><span class="sxs-lookup"><span data-stu-id="f2fb5-175">If the application updates the content for the CDN, perhaps at regular intervals or in response to an event, it must store the updated content in any additional locations as well as the endpoint for the CDN.</span></span>

<span data-ttu-id="f2fb5-176">静的コンテンツが CDN から提供されることを期待している場合、ローカル開発およびテストを処理する方法を検討してください。</span><span class="sxs-lookup"><span data-stu-id="f2fb5-176">Consider how you will handle local development and testing when some static content is expected to be served from a CDN.</span></span> <span data-ttu-id="f2fb5-177">たとえば、コンテンツをビルド スクリプトの一部として CDN に事前デプロイすることが可能です。</span><span class="sxs-lookup"><span data-stu-id="f2fb5-177">For example, you could pre-deploy the content to the CDN as part of your build script.</span></span> <span data-ttu-id="f2fb5-178">また、コンパイル ディレクティブまたはフラグを使用して、アプリケーションがリソースを読み込む方法を制御します。</span><span class="sxs-lookup"><span data-stu-id="f2fb5-178">Alternatively, use compile directives or flags to control how the application loads the resources.</span></span> <span data-ttu-id="f2fb5-179">たとえば、デバッグ モードでは、アプリケーションがローカル フォルダーから静的リソースを読み込むことが可能です。</span><span class="sxs-lookup"><span data-stu-id="f2fb5-179">For example, in debug mode, the application could load static resources from a local folder.</span></span> <span data-ttu-id="f2fb5-180">リリース モードでは、アプリケーションは CDN を使用します。</span><span class="sxs-lookup"><span data-stu-id="f2fb5-180">In release mode, the application would use the CDN.</span></span>

<span data-ttu-id="f2fb5-181">gzip (GNU zip) などのファイル圧縮のオプションを検討してください。</span><span class="sxs-lookup"><span data-stu-id="f2fb5-181">Consider the options for file compression, such as gzip (GNU zip).</span></span> <span data-ttu-id="f2fb5-182">圧縮は、Web アプリケーション ホスティングによって元のサーバーで実行するか、または CDN によってエッジ サーバー上で直接実行できます。</span><span class="sxs-lookup"><span data-stu-id="f2fb5-182">Compression may be performed on the origin server by the web application hosting or directly on the edge servers by the CDN.</span></span> <span data-ttu-id="f2fb5-183">詳細については、「[Azure CDN でのファイル圧縮によるパフォーマンスの向上](/azure/cdn/cdn-improve-performance)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="f2fb5-183">For more information, see [Improve performance by compressing files in Azure CDN](/azure/cdn/cdn-improve-performance).</span></span>

### <a name="routing-and-versioning"></a><span data-ttu-id="f2fb5-184">ルーティングとバージョン管理</span><span class="sxs-lookup"><span data-stu-id="f2fb5-184">Routing and versioning</span></span>

<span data-ttu-id="f2fb5-185">さまざまな時点でそれぞれ異なる CDN インスタンスを使用することが必要な場合があります。</span><span class="sxs-lookup"><span data-stu-id="f2fb5-185">You may need to use different CDN instances at various times.</span></span> <span data-ttu-id="f2fb5-186">たとえば、アプリケーションの新しいバージョンをデプロイする場合は、新しい CDN を使用し、前の CDN は以前のバージョンのために保持することができます (以前の形式でコンテンツを保持)。</span><span class="sxs-lookup"><span data-stu-id="f2fb5-186">For example, when you deploy a new version of the application you may want to use a new CDN and retain the old CDN (holding content in an older format) for previous versions.</span></span> <span data-ttu-id="f2fb5-187">コンテンツ配信元として Azure BLOB ストレージを使用している場合は、別のストレージ アカウントまたは別のコンテナーを作成し、CDN エンドポイントでその場所を指定します。</span><span class="sxs-lookup"><span data-stu-id="f2fb5-187">If you use Azure blob storage as the content origin, you can create a separate storage account or a separate container and point the CDN endpoint to it.</span></span>

<span data-ttu-id="f2fb5-188">Azure BLOB ストレージからコンテンツを取得するときに、クエリ文字列はリソース名 (BLOB 名) の一部になるので、CDN 上のリソースに対するリンクで、クエリ文字列を使用してアプリケーションの別バージョンを指定しないでください。</span><span class="sxs-lookup"><span data-stu-id="f2fb5-188">Do not use the query string to denote different versions of the application in links to resources on the CDN because, when retrieving content from Azure blob storage, the query string is part of the resource name (the blob name).</span></span> <span data-ttu-id="f2fb5-189">この方法はまた、クライアントでリソースをキャッシュする方法に影響する可能性があります。</span><span class="sxs-lookup"><span data-stu-id="f2fb5-189">This approach can also affect how the client caches resources.</span></span>

<span data-ttu-id="f2fb5-190">以前のリソースが CDN にキャッシュされている場合、アプリケーションの更新時に新しいバージョンの静的コンテンツをデプロイすることが困難になる可能性があります。</span><span class="sxs-lookup"><span data-stu-id="f2fb5-190">Deploying new versions of static content when you update an application can be a challenge if the previous resources are cached on the CDN.</span></span> <span data-ttu-id="f2fb5-191">詳細については、キャッシュ制御のセクションをご覧ください。</span><span class="sxs-lookup"><span data-stu-id="f2fb5-191">For more information, see the section on cache control, below.</span></span>

<span data-ttu-id="f2fb5-192">国によって CDN コンテンツへのアクセスを制限することを検討してください。</span><span class="sxs-lookup"><span data-stu-id="f2fb5-192">Consider restricting the CDN content access by country.</span></span> <span data-ttu-id="f2fb5-193">Azure CDN を使用すると、発信元の国に基づいて要求をフィルター処理し、配信するコンテンツを制限することができます。</span><span class="sxs-lookup"><span data-stu-id="f2fb5-193">Azure CDN allows you to filter requests based on the country of origin and restrict the content delivered.</span></span> <span data-ttu-id="f2fb5-194">詳細については、「[国に応じてコンテンツへのアクセスを制限する](/azure/cdn/cdn-restrict-access-by-country/)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="f2fb5-194">For more information, see [Restrict access to your content by country](/azure/cdn/cdn-restrict-access-by-country/).</span></span>

### <a name="cache-control"></a><span data-ttu-id="f2fb5-195">キャッシュ制御</span><span class="sxs-lookup"><span data-stu-id="f2fb5-195">Cache control</span></span>

<span data-ttu-id="f2fb5-196">システム内でのキャッシュの管理方法について検討します。</span><span class="sxs-lookup"><span data-stu-id="f2fb5-196">Consider how to manage caching within the system.</span></span> <span data-ttu-id="f2fb5-197">たとえば、Azure CDN では、グローバル キャッシュ規則を設定してから、特定の元のエンドポイントに対するカスタム キャッシュを設定できます。</span><span class="sxs-lookup"><span data-stu-id="f2fb5-197">For example, in Azure CDN, you can set global caching rules, and then set custom caching for particular origin endpoints.</span></span> <span data-ttu-id="f2fb5-198">また、配信元でキャッシュ ディレクティブ ヘッダーを送信することによって CDN でのキャッシュの実行方法を制御できます。</span><span class="sxs-lookup"><span data-stu-id="f2fb5-198">You can also control how caching is performed in a CDN by sending cache-directive headers at the origin.</span></span>

<span data-ttu-id="f2fb5-199">詳細については、「[キャッシュのしくみ](/azure/cdn/cdn-how-caching-works)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="f2fb5-199">For more information, see [How caching works](/azure/cdn/cdn-how-caching-works).</span></span>

<span data-ttu-id="f2fb5-200">オブジェクトを CDN で使用できないようにするには、配信元からオブジェクトを削除するか、または、CDN エンドポイントを削除します。BLOB ストレージの場合は、コンテナーまたは BLOB を非公開にします。</span><span class="sxs-lookup"><span data-stu-id="f2fb5-200">To prevent objects from being available on the CDN, you can delete them from the origin, remove or delete the CDN endpoint, or in the case of blob storage, make the container or blob private.</span></span> <span data-ttu-id="f2fb5-201">ただし、有効期限が切れるまで、項目は削除されません。</span><span class="sxs-lookup"><span data-stu-id="f2fb5-201">However, items are not removed from the until the time-to-live expires.</span></span> <span data-ttu-id="f2fb5-202">手動で CDN エンドポイントを消去することもできます。</span><span class="sxs-lookup"><span data-stu-id="f2fb5-202">You can also manually purge a CDN endpoint.</span></span>

### <a name="security"></a><span data-ttu-id="f2fb5-203">セキュリティ</span><span class="sxs-lookup"><span data-stu-id="f2fb5-203">Security</span></span>

<span data-ttu-id="f2fb5-204">CDN は、CDN から提供された証明書を使用して HTTPS (SSL) 上でコンテンツを配信できますが、HTTP 上で配信することもできます。</span><span class="sxs-lookup"><span data-stu-id="f2fb5-204">The CDN can deliver content over HTTPS (SSL), by using the certificate provided by the CDN, as well as over standard HTTP.</span></span> <span data-ttu-id="f2fb5-205">コンテンツが混合している事に関するブラウザーからの警告を避けるには、HTTPS を使用して、HTTPS 経由で読み込まれたページに表示されている静的コンテンツを要求する必要があります。</span><span class="sxs-lookup"><span data-stu-id="f2fb5-205">To avoid browser warnings about mixed content, you might need to use HTTPS to request static content that is displayed in pages loaded through HTTPS.</span></span>

<span data-ttu-id="f2fb5-206">CDN を使用してフロント ファイルなどの静的アセットを配信する場合は、 *XMLHttpRequest* 呼び出しを使用して異なるドメインからこれらのリソースを要求すると、同じ配信元ポリシーの問題が起こる場合があります。</span><span class="sxs-lookup"><span data-stu-id="f2fb5-206">If you deliver static assets such as font files by using the CDN, you might encounter same-origin policy issues if you use an *XMLHttpRequest* call to request these resources from a different domain.</span></span> <span data-ttu-id="f2fb5-207">多くの Web ブラウザーは、適切な応答ヘッダーを設定するように Web サーバーが構成されていない場合、クロス オリジン リソース共有 (CORS) を回避します。</span><span class="sxs-lookup"><span data-stu-id="f2fb5-207">Many web browsers prevent cross-origin resource sharing (CORS) unless the web server is configured to set the appropriate response headers.</span></span> <span data-ttu-id="f2fb5-208">次のいずれかの方法を使用して、CORS をサポートする CDN を構成できます。</span><span class="sxs-lookup"><span data-stu-id="f2fb5-208">You can configure the CDN to support CORS by using one of the following methods:</span></span>

- <span data-ttu-id="f2fb5-209">CDN を構成して、CORS ヘッダーを応答に追加します。</span><span class="sxs-lookup"><span data-stu-id="f2fb5-209">Configure the CDN to add CORS headers to the responses.</span></span> <span data-ttu-id="f2fb5-210">詳細については、[CORS を使用する Azure CDN](/azure/cdn/cdn-cors) に関するページを参照してください。</span><span class="sxs-lookup"><span data-stu-id="f2fb5-210">For more information, see [Using Azure CDN with CORS](/azure/cdn/cdn-cors).</span></span>

- <span data-ttu-id="f2fb5-211">配信元が Azure Blob ストレージの場合は、ストレージ エンドポイントに CORS 規則を追加します。</span><span class="sxs-lookup"><span data-stu-id="f2fb5-211">If the origin is Azure blob storage, add CORS rules to the storage endpoint.</span></span> <span data-ttu-id="f2fb5-212">詳細については、「 [Azure ストレージ サービスでのクロス オリジン リソース共有 (CORS) のサポート](/rest/api/storageservices/Cross-Origin-Resource-Sharing--CORS--Support-for-the-Azure-Storage-Services)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="f2fb5-212">For more information, see [Cross-Origin Resource Sharing (CORS) Support for the Azure Storage Services](/rest/api/storageservices/Cross-Origin-Resource-Sharing--CORS--Support-for-the-Azure-Storage-Services).</span></span>

- <span data-ttu-id="f2fb5-213">アプリケーションを構成して、CORS ヘッダーを設定します。</span><span class="sxs-lookup"><span data-stu-id="f2fb5-213">Configure the application to set the CORS headers.</span></span> <span data-ttu-id="f2fb5-214">たとえば、ASP.NET Core ドキュメントの「[クロス オリジン要求 (CORS) を有効にします](/aspnet/core/security/cors)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="f2fb5-214">For example, see [Enabling Cross-Origin Requests (CORS)](/aspnet/core/security/cors) in the ASP.NET Core documentation.</span></span>

### <a name="cdn-fallback"></a><span data-ttu-id="f2fb5-215">CDN フォールバック</span><span class="sxs-lookup"><span data-stu-id="f2fb5-215">CDN fallback</span></span>

<span data-ttu-id="f2fb5-216">CDN のエラーや一時的な使用不能状態に対するアプリケーションの対応方法を考慮する必要があります。</span><span class="sxs-lookup"><span data-stu-id="f2fb5-216">Consider how your application will cope with a failure or temporary unavailability of the CDN.</span></span> <span data-ttu-id="f2fb5-217">クライアント アプリケーションは、前回の要求中に (クライアントの) ローカルにキャッシュされたリソースのコピーを使用できる場合があります。CDN を使用できない場合は、エラーを検出すると、そこで配信元 (リソースが保存されているアプリケーション フォルダーまたは Azure BLOB コンテナー) にリソースを要求するコードを含めることもできます。</span><span class="sxs-lookup"><span data-stu-id="f2fb5-217">Client applications may be able to use copies of the resources that were cached locally (on the client) during previous requests, or you can include code that detects failure and instead requests resources from the origin (the application folder or Azure blob container that holds the resources) if the CDN is unavailable.</span></span>
