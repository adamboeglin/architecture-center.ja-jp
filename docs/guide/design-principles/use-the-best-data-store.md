---
title: ジョブに最適なデータ ストアの使用
titleSuffix: Azure Application Architecture Guide
description: データに最適なストレージ技術とその使用方法を選択します。
author: MikeWasson
ms.date: 08/30/2018
ms.topic: guide
ms.service: architecture-center
ms.subservice: reference-architecture
ms.custom: seojan19
ms.openlocfilehash: 2f83e7a184e8fa94f49da4e8fd5252396ecfd632
ms.sourcegitcommit: c053e6edb429299a0ad9b327888d596c48859d4a
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/20/2019
ms.locfileid: "58242013"
---
# <a name="use-the-best-data-store-for-the-job"></a><span data-ttu-id="06c84-103">ジョブに最適なデータ ストアの使用</span><span class="sxs-lookup"><span data-stu-id="06c84-103">Use the best data store for the job</span></span>

## <a name="pick-the-storage-technology-that-is-the-best-fit-for-your-data-and-how-it-will-be-used"></a><span data-ttu-id="06c84-104">データに最適なストレージ技術とその使用方法を選択する</span><span class="sxs-lookup"><span data-stu-id="06c84-104">Pick the storage technology that is the best fit for your data and how it will be used</span></span>

<span data-ttu-id="06c84-105">すべてのデータを大規模なリレーショナル SQL データベースに格納するだけ、というのは過去の話です。</span><span class="sxs-lookup"><span data-stu-id="06c84-105">Gone are the days when you would just stick all of your data into a big relational SQL database.</span></span> <span data-ttu-id="06c84-106">リレーショナル データベースは ACID がリレーショナル データに対するトランザクションを保証するという前提において、非常に有用です。</span><span class="sxs-lookup"><span data-stu-id="06c84-106">Relational databases are very good at what they do &mdash; providing ACID guarantees for transactions over relational data.</span></span> <span data-ttu-id="06c84-107">ただし、これらにはいくつかの代償があります。</span><span class="sxs-lookup"><span data-stu-id="06c84-107">But they come with some costs:</span></span>

- <span data-ttu-id="06c84-108">クエリには、負荷の高い結合が必要となる場合があります。</span><span class="sxs-lookup"><span data-stu-id="06c84-108">Queries may require expensive joins.</span></span>
- <span data-ttu-id="06c84-109">データは正規化され、定義済みのスキーマ (書き込み時のスキーマ) に準拠している必要があります。</span><span class="sxs-lookup"><span data-stu-id="06c84-109">Data must be normalized and conform to a predefined schema (schema on write).</span></span>
- <span data-ttu-id="06c84-110">ロックの競合は、パフォーマンスに影響を及ぼす可能性があります。</span><span class="sxs-lookup"><span data-stu-id="06c84-110">Lock contention may impact performance.</span></span>

<span data-ttu-id="06c84-111">すべての大規模なソリューションでは、多くの場合、1 つのデータ ストア テクノロジですべてのニーズが満たされることはありません。</span><span class="sxs-lookup"><span data-stu-id="06c84-111">In any large solution, it's likely that a single data store technology won't fill all your needs.</span></span> <span data-ttu-id="06c84-112">リレーショナル データベースの代替には、キー/値ストア、ドキュメント データベース、検索エンジンのデータベース、時系列データベース、列指向データベース、およびグラフ データベースなどがあります。</span><span class="sxs-lookup"><span data-stu-id="06c84-112">Alternatives to relational databases include key/value stores, document databases, search engine databases, time series databases, column family databases, and graph databases.</span></span> <span data-ttu-id="06c84-113">それぞれに長所と短所があり、より自然に適合する、さまざまなデータの種類があります。</span><span class="sxs-lookup"><span data-stu-id="06c84-113">Each has pros and cons, and different types of data fit more naturally into one or another.</span></span>

<span data-ttu-id="06c84-114">たとえば、柔軟なスキーマが可能な Cosmos DB などのドキュメント データベースに製品カタログを格納することがあります。</span><span class="sxs-lookup"><span data-stu-id="06c84-114">For example, you might store a product catalog in a document database, such as Cosmos DB, which allows for a flexible schema.</span></span> <span data-ttu-id="06c84-115">この場合、製品の説明はそれぞれ自己完結型ドキュメントです。</span><span class="sxs-lookup"><span data-stu-id="06c84-115">In that case, each product description is a self-contained document.</span></span> <span data-ttu-id="06c84-116">カタログ全体のクエリの場合は、カタログのインデックスを作成し、Azure Search にインデックスを格納することがあります。</span><span class="sxs-lookup"><span data-stu-id="06c84-116">For queries over the entire catalog, you might index the catalog and store the index in Azure Search.</span></span> <span data-ttu-id="06c84-117">データが ACID 保証を必要とするため、製品一覧は SQL データベースに格納されます。</span><span class="sxs-lookup"><span data-stu-id="06c84-117">Product inventory might go into a SQL database, because that data requires ACID guarantees.</span></span>

<span data-ttu-id="06c84-118">このデータに含まれるのは、永続化されたアプリケーション データだけではないことに注意してください。</span><span class="sxs-lookup"><span data-stu-id="06c84-118">Remember that data includes more than just the persisted application data.</span></span> <span data-ttu-id="06c84-119">アプリケーション ログ、イベント、メッセージ、およびキャッシュも含まれています。</span><span class="sxs-lookup"><span data-stu-id="06c84-119">It also includes application logs, events, messages, and caches.</span></span>

## <a name="recommendations"></a><span data-ttu-id="06c84-120">Recommendations</span><span class="sxs-lookup"><span data-stu-id="06c84-120">Recommendations</span></span>

<span data-ttu-id="06c84-121">**リレーショナル データベースをすべてに対して使用しない**。</span><span class="sxs-lookup"><span data-stu-id="06c84-121">**Don't use a relational database for everything**.</span></span> <span data-ttu-id="06c84-122">適切な場合は、その他のデータ ストアの使用を検討してください。</span><span class="sxs-lookup"><span data-stu-id="06c84-122">Consider other data stores when appropriate.</span></span> <span data-ttu-id="06c84-123">「[Choose the right data store (適切なデータ ストアの選択)][data-store-overview]」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="06c84-123">See [Choose the right data store][data-store-overview].</span></span>

<span data-ttu-id="06c84-124">**多言語パーシステンスを受け入れる**。</span><span class="sxs-lookup"><span data-stu-id="06c84-124">**Embrace polyglot persistence**.</span></span> <span data-ttu-id="06c84-125">すべての大規模なソリューションでは、多くの場合、1 つのデータ ストア テクノロジですべてのニーズが満たされることはありません。</span><span class="sxs-lookup"><span data-stu-id="06c84-125">In any large solution, it's likely that a single data store technology won't fill all your needs.</span></span>

<span data-ttu-id="06c84-126">**データの種類を検討する**。</span><span class="sxs-lookup"><span data-stu-id="06c84-126">**Consider the type of data**.</span></span> <span data-ttu-id="06c84-127">たとえば、トランザクション データを SQL に、JSON ドキュメントをドキュメント データベースに、テレメトリ データを時系列データベースに、アプリケーション ログを Elasticsearch に、および BLOB を Azure Blob Storage に格納します。</span><span class="sxs-lookup"><span data-stu-id="06c84-127">For example, put transactional data into SQL, put JSON documents into a document database, put telemetry data into a time series data base, put application logs in Elasticsearch, and put blobs in Azure Blob Storage.</span></span>

<span data-ttu-id="06c84-128">**一貫性より可用性を優先する**。</span><span class="sxs-lookup"><span data-stu-id="06c84-128">**Prefer availability over (strong) consistency**.</span></span> <span data-ttu-id="06c84-129">CAP 定理では、分散システムにおいては可用性と整合性とのトレードオフが避けられないことが示されています。</span><span class="sxs-lookup"><span data-stu-id="06c84-129">The CAP theorem implies that a distributed system must make trade-offs between availability and consistency.</span></span> <span data-ttu-id="06c84-130">(CAP 定理のもう 1 つの要素であるネットワークの分断を完全に回避することは不可能です。)多くの場合、*"最終的な一貫性"* モデルを採用すると、より高い可用性を得ることができます。</span><span class="sxs-lookup"><span data-stu-id="06c84-130">(Network partitions, the other leg of the CAP theorem, can never be completely avoided.) Often, you can achieve higher availability by adopting an *eventual consistency* model.</span></span>

<span data-ttu-id="06c84-131">**開発チームのスキル セットを検討する**。</span><span class="sxs-lookup"><span data-stu-id="06c84-131">**Consider the skill set of the development team**.</span></span> <span data-ttu-id="06c84-132">多言語パーシステンスを利用することにはメリットがありますが、過度になることがあります。</span><span class="sxs-lookup"><span data-stu-id="06c84-132">There are advantages to using polyglot persistence, but it's possible to go overboard.</span></span> <span data-ttu-id="06c84-133">新しいデータ ストレージ テクノロジを採用するには、新しいスキルのセットが必要です。</span><span class="sxs-lookup"><span data-stu-id="06c84-133">Adopting a new data storage technology requires a new set of skills.</span></span> <span data-ttu-id="06c84-134">開発チームは、テクノロジを最大限に活用する方法を理解する必要があります。</span><span class="sxs-lookup"><span data-stu-id="06c84-134">The development team must understand how to get the most out of the technology.</span></span> <span data-ttu-id="06c84-135">適切な使用パターン、クエリを最適化する方法、パフォーマンスの調整などを理解しなければなりません。</span><span class="sxs-lookup"><span data-stu-id="06c84-135">They must understand appropriate usage patterns, how to optimize queries, tune for performance, and so on.</span></span> <span data-ttu-id="06c84-136">ストレージ テクノロジを検討するときに、このことを考慮してください。</span><span class="sxs-lookup"><span data-stu-id="06c84-136">Factor this in when considering storage technologies.</span></span>

<span data-ttu-id="06c84-137">**補正トランザクションを使用する**。</span><span class="sxs-lookup"><span data-stu-id="06c84-137">**Use compensating transactions**.</span></span> <span data-ttu-id="06c84-138">多言語パーシステンスの副作用は、1 つのトランザクションが複数のストアにデータを書き込む可能性があるということです。</span><span class="sxs-lookup"><span data-stu-id="06c84-138">A side effect of polyglot persistence is that single transaction might write data to multiple stores.</span></span> <span data-ttu-id="06c84-139">何かが失敗した場合は、既に完了しているすべての手順を元に戻す補正トランザクションを使用します。</span><span class="sxs-lookup"><span data-stu-id="06c84-139">If something fails, use compensating transactions to undo any steps that already completed.</span></span>

<span data-ttu-id="06c84-140">**コンテキスト境界を確認する**。</span><span class="sxs-lookup"><span data-stu-id="06c84-140">**Look at bounded contexts**.</span></span> <span data-ttu-id="06c84-141">"*コンテキスト境界*" は、ドメイン駆動型設計の用語です。</span><span class="sxs-lookup"><span data-stu-id="06c84-141">*Bounded context* is a term from domain driven design.</span></span> <span data-ttu-id="06c84-142">コンテキスト境界は、ドメイン モデルの周囲の明示的な境界であり、ドメインのどの部分にモデルが適用されるかを定義します。</span><span class="sxs-lookup"><span data-stu-id="06c84-142">A bounded context is an explicit boundary around a domain model, and defines which parts of the domain the model applies to.</span></span> <span data-ttu-id="06c84-143">コンテキスト境界がビジネス ドメインのサブドメインにマッピングされるのが理想です。</span><span class="sxs-lookup"><span data-stu-id="06c84-143">Ideally, a bounded context maps to a subdomain of the business domain.</span></span> <span data-ttu-id="06c84-144">ご利用のシステムにおけるコンテキスト境界は、多言語パーシステンスを検討するのに適しています。</span><span class="sxs-lookup"><span data-stu-id="06c84-144">The bounded contexts in your system are a natural place to consider polyglot persistence.</span></span> <span data-ttu-id="06c84-145">たとえば、"製品" が製品カタログのサブドメインと製品在庫のサブドメインの両方に表示されますが、多くの場合、これら 2 つのサブドメインには製品の格納、更新、および照会について異なる要件があります。</span><span class="sxs-lookup"><span data-stu-id="06c84-145">For example, "products" may appear in both the Product Catalog subdomain and the Product Inventory subdomain, but it's very likely that these two subdomains have different requirements for storing, updating, and querying products.</span></span>

[data-store-overview]: ../technology-choices/data-store-overview.md
